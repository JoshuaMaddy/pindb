<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form id="myForm" method="post" enctype="multipart/form-data">
      <div
        id="image_drop"
        style="
          width: 200px;
          height: 200px;
          border: 2px dashed #999;
          display: flex;
          justify-content: center;
          align-items: center;
          cursor: pointer;
          background-size: cover;
          background-position: center;
        "
      >
        Drop or Click
      </div>

      <input
        type="file"
        id="image_input"
        name="image"
        accept="image/*"
        style="display: none"
      />

      <button type="submit">Submit</button>
    </form>
  </body>
  <script>
    const drop = document.getElementById("image_drop");
    const input = document.getElementById("image_input");

    // Clicking opens file dialog
    drop.addEventListener("click", () => input.click());

    // When user selects a file manually
    input.addEventListener("change", () => {
      if (input.files[0]) {
        showPreview(input.files[0]);
      }
    });

    // Drag events
    drop.addEventListener("dragover", (e) => {
      e.preventDefault();
      drop.style.borderColor = "green";
    });

    drop.addEventListener("dragleave", () => {
      drop.style.borderColor = "#999";
    });

    // Dropping a file
    drop.addEventListener("drop", (e) => {
      e.preventDefault();
      drop.style.borderColor = "#999";

      const file = e.dataTransfer.files[0];
      if (!file) return;

      // ðŸ”¥ Key trick: put dropped file into the <input>
      const dt = new DataTransfer();
      dt.items.add(file);
      input.files = dt.files;

      showPreview(file);
    });

    // Show image preview
    function showPreview(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        drop.style.backgroundImage = `url('${e.target.result}')`;
        drop.textContent = ""; // hide label
      };
      reader.readAsDataURL(file);
    }
  </script>
</html>
